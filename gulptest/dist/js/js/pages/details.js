"use strict";function Head(){this.head=$("#HEAD"),this.foot=$("#FOOT"),this.fixnav=$("#FIXNAV")}function Proinfor(){this.pro_look=$("#pro_look"),this.pro_infor=$("#pro_infor"),this.section2=$("#section2"),this.pro_intro_imgs=$("#pro_intro_imgs"),this.pro_title=$(".protit")}$.extend(Head.prototype,{init:function(){this.createDom()},createDom:function(){this.element=new CreHeader(this.head),this.element=new CreFooter(this.foot),this.element=new Crefixnav(this.fixnav)}}),(new Head).init(),$.extend(Proinfor.prototype,{init:function(){this.getdata()},getdata:function(){$.ajax({type:"post",url:"http://localhost/work/yigu/src/php/select.php",data:{},dataType:"json",success:$.proxy(this.add,this)})},add:function(t){if(localStorage.getItem("buy_data")){var i=JSON.parse(localStorage.getItem("buy_data")),n="",s="",a="",e="",o=[],r=[];for(var p in i)for(var l=0;l<t.length;l++)if(p==t[l].did){if(this.pro_title.html(t[l].title),""!=t[l].simg){r=JSON.parse(t[l].simg);for(var h=0;h<r.length;)a+='\n\t\t\t                \t<img src="'+r[h]+'" class="small"  data-url="'+r[h]+'">\n\t\t\t                \t',h++;e=$("<div class = 'smails'></div>").append(a)}n='\n\t\t\t\t\t    <div id="box">\n\t\t\t\t\t\t\t<img src="'+t[l].img+'" class="middle" width="400" height="400">\n\t\t\t\t\t\t\t<div id="filter"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="max">\n\t\t\t\t\t\t\t<img src="'+t[l].img+'" id="maxImg" style="width:800px;height:800px;">\n\t\t\t\t\t\t</div>\n\t\t                 ',s="\n\t\t\t\t\t\t\t<h3>"+t[l].title+"</h3>\n\t\t\t\t\t\t\t<p>"+t[l].p+'</p>\n\t\t\t\t\t\t\t<div class="prices">\n\t\t\t\t\t\t\t\t<p>市场价：￥<span>'+t[l].mprice+'</span></p>\n\t\t\t\t\t\t\t\t<p>商城价：<span>￥<em class="price">'+t[l].price+'</em></span></p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<p><span>月销量</span><span class="tit">'+t[l].sale+'</span></p>\n\t\t\t\t\t\t\t<div class="serve">\n\t\t\t\t\t\t\t\t<p><span class="sign">配送</span>16:00 前完成订单,预计明日(05-14)送达,生鲜商品仅限深圳!</p>\n\t\t\t\t\t\t\t\t<p><span class="sign">运费</span>深圳市内每单物流费8元起，满199元免物流!</p>\n\t\t\t\t\t\t\t\t<p><span class="sign">提示</span>产品图片及描述内容仅做参考,请您以收到的商品实物为准！谢谢</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="tomap">\n\t\t\t\t\t\t\t\t<p><span>配送至：</span><input type="text" value="深圳市内" /></p>\n\t\t\t\t\t\t\t\t<p><span>规格：</span><span class="kg">'+t[l].guige+'</span></p>\n\t\t\t\t\t\t\t\t<div class="countnum"><span>数量：</span><span class="num">1</span><div class="btn"><span class="addbtn">+</span><span class="decbtn">-</span></div>\n\t\t\t\t\t\t\t\t<a href="##"><i class="iconfont icon-share_light"></i><span>分享</span></a>\n\t\t\t\t\t\t\t\t<a href="##"><i class="iconfont icon-favor_light"></i><span>收藏</span></a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="abtn">\n\t\t\t\t\t\t\t\t<a href="##" class="buy"  data-id="'+t[l].did+'">立即购买</a>\n\t\t\t\t\t\t\t\t<a href="##" class="addshop"  data-id="'+t[l].did+'"><i class="iconfont icon-cart_light"></i>加入购物车</a>\n\t\t\t\t\t\t\t</div>\n\t\t                 ',""!=t[l].intro&&(o=JSON.parse(t[l].intro)),this.pro_look.html(n).append(e),this.pro_infor.html(s)}}if(0<o.length)for(var l in o){var c=$("<img/>");c.attr("src",o[l]),this.pro_intro_imgs.append(c)}}}),(new Proinfor).init(),window.onload=function(){function t(){this.filter=$("#filter"),this.box=$("#box"),this.max=$("#max"),this.smalls=$(".small"),this.maxImg=$("#max img"),this.boxImg=$("#box img")}function i(){this.pri=$(".price"),this.num=$(".num"),this.add=$(".addbtn"),this.dre=$(".decbtn")}function n(){this.abtn=$(".abtn"),this.num=$(".num")}new Swiper(".swiper-container",{direction:"vertical",loop:!0,autoplay:{autoplay:!0,delay:5e3},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},effect:"slide"}),$.extend(t.prototype,{init:function(){this.over()},over:function(){var r=this;this.box.mouseover(function(){r.filter.css("display","block"),r.max.css("display","block")}),this.box.mouseout(function(){r.filter.css("display","none"),r.max.css("display","none")}),this.box.mousemove(function(t){var i=t.pageX-r.filter.width()/2-r.box.offset().left,n=t.pageY-r.filter.height()/2-r.box.offset().top,s=r.box.width()-r.filter.width(),a=r.box.height()-r.filter.height();i=s<i?s:i<0?0:i,n=a<n?a:n<0?0:n,r.filter.css({left:i,top:n});var e=-i/s*(r.maxImg.width()-r.max.width()),o=-n/a*(r.maxImg.height()-r.max.height());r.maxImg.css({left:e,top:o})}),this.smalls.mouseover(function(){var t=$(this).attr("data-url");r.maxImg.attr("src",t),r.boxImg.attr("src",t)})}}),(new t).init(),$.extend(i.prototype,{init:function(){this.add.click($.proxy(this.addup,this)),this.dre.click($.proxy(this.dreup,this))},addup:function(){var t=Number(this.num.html());Number(this.pri.html());t++,console.log(this.num.html()),this.num.html(t)},dreup:function(){var t=Number(this.num.html());t<1&&(t=1),t--,this.num.html(t)}}),(new i).init(),$.extend(n.prototype,{init:function(){this.abtn.click($.proxy(this.btnclick,this))},btnclick:function(t){var i={},n=t.target||t.srcElement;if(console.log(n),"A"==n.tagName&&"buy"==n.className){var s=$(n).attr("data-id");console.log(this.num);var a=Number(this.num.html());i[s]=a;var e=JSON.stringify(i);localStorage.setItem("buy_list",e),location.href="list.html"}if("A"==n.tagName&&"addshop"==n.className){(a=i[s=$(n).attr("data-id")])?a++:a=Number(this.num.html()),i[s]=a;e=JSON.stringify(i);localStorage.setItem("buy_shop",e)}}}),(new n).init()};
"use strict";function Head(){this.head=$("#HEAD"),this.foot=$("#FOOT"),this.fixnav=$("#FIXNAV")}function Addproduct(){this.list=$("#list")}function List(){this.section=$("#section"),this.listbox=$("#list"),this.all1=$("#all1"),this.all2=$("#all2"),this.chooses=$("#list .choose"),this.price=$("#price"),this.decrease=$("#decrease"),this.increase=$("#increase"),this.num=$("#num"),this.sum=$("#sum"),this.del=$("#del"),this.btn=$("#btn"),this.countNum=$("#countNum"),this.total=$("#total"),this.totalPrice=0,this.totalNum=0}$.extend(Head.prototype,{init:function(){this.createDom()},createDom:function(){this.element=new CreHeader(this.head),this.element=new CreFooter(this.foot),this.element=new Crefixnav(this.fixnav)}}),(new Head).init(),$.extend(Addproduct.prototype,{init:function(){$.ajax({type:"post",url:"http://localhost/work/yigu/src/php/select.php",data:{},dataType:"json",success:$.proxy(this.adddl,this)})},adddl:function(e){if(localStorage.getItem("buy_list")){var t=JSON.parse(localStorage.getItem("buy_list")),i="";for(var s in t)for(var d in e)if(s==e[d].did){i='<dl>\n              <dd><input type="checkbox" class="choose"  checked="false" ></dd>\n              <dd><img src="'+e[d].img+'"></dd>\n              <dd><a href="#">'+e[d].title+'</a></dd>   \n              <dd>¥<span id="price">'+e[d].price+'</span></dd>\n              <dd><span id="decrease">-</span><span id="num">'+t[s]+'</span><span id="increase">+</span></dd>\n              <dd>¥<span id="sum">'+e[d].price*t[s]+'</span></dd>\n              <dd><a href="#" id="move">移入收藏</a><a href="#" id="del">删除</a></dd>\n          </dl>';this.list.append(i)}}if(localStorage.getItem("buy_shop")){var a=JSON.parse(localStorage.getItem("buy_shop"));i="";for(var s in a)for(var d in e)if(s==e[d].did){i='<dl>\n              <dd><input type="checkbox" class="choose"  checked="false" ></dd>\n              <dd><img src="'+e[d].img+'"></dd>\n              <dd><a href="#">'+e[d].title+'</a></dd>   \n              <dd>¥<span id="price">'+e[d].price+'</span></dd>\n              <dd><span id="decrease">-</span><span id="num">'+a[s]+'</span><span id="increase">+</span></dd>\n              <dd>¥<span id="sum">'+e[d].price*a[s]+'</span></dd>\n              <dd><a href="#" id="move">移入收藏</a><a href="#" id="del">删除</a></dd>\n          </dl>';this.list.append(i)}}if(localStorage.getItem("shop")){var n=JSON.parse(localStorage.getItem("shop"));i="";for(var s in n)for(var d in e)if(s==e[d].did){i='<dl>\n              <dd><input type="checkbox" class="choose"  checked="false" ></dd>\n              <dd><img src="'+e[d].img+'"></dd>\n              <dd><a href="#">'+e[d].title+'</a></dd>   \n              <dd>¥<span id="price">'+e[d].price+'</span></dd>\n              <dd><span id="decrease">-</span><span id="num">'+n[s]+'</span><span id="increase">+</span></dd>\n              <dd>¥<span id="sum">'+e[d].price*n[s]+'</span></dd>\n              <dd><a href="#" id="move">移入收藏</a><a href="#" id="del">删除</a></dd>\n          </dl>';this.list.append(i)}}}}),(new Addproduct).init(),$.extend(List.prototype,{init:function(){this.selectall(),this.events()},selectall:function(){for(var e=0;e<this.chooses.length;e++)this.chooses.eq(e).click($.proxy(this.choosecheck,this))},choosecheck:function(){for(var e=!0,t=0;t<this.chooses.length;t++)if(!this.chooses.eq(t).prop("checked")){e=!1;break}e?(this.all1.prop("checked",!0),this.all2.prop("checked",!0)):(this.all1.prop("checked",!1),this.all2.prop("checked",!1))},events:function(){this.section.click($.proxy(this.targets,this))},targets:function(e){var t=e.target||e.srcElement;if("INPUT"==t.tagName&&"all1"==t.id||"INPUT"==t.tagName&&"all2"==t.id)if("all1"==t.id)if($(t).prop("checked")){for(var i=0;i<this.chooses.length;i++)this.chooses.eq(i).prop("checked",!0);this.all2.prop("checked",!0)}else{for(i=0;i<this.chooses.length;i++)this.chooses.eq(i).prop("checked",!1);this.all2.prop("checked",!1)}else if($(t).prop("checked")){for(i=0;i<this.chooses.length;i++)this.chooses.eq(i).prop("checked",!0);this.all1.prop("checked",!0)}else{for(i=0;i<this.chooses.length;i++)this.chooses.eq(i).prop("checked",!1);this.all1.prop("checked",!1)}if("SPAN"==t.tagName&&"increase"==t.id){var s=Number($(t).prev().html());s++;var d=Number($(t).parent().prev().find("#price").html());$(t).prev().html(s),$(t).parent().next().first().html("￥"+s*d)}if("SPAN"==t.tagName&&"decrease"==t.id){s=Number($(t).next().html());if(--s<0)return void(s=0);d=Number($(t).parent().prev().find("#price").html());$(t).next().html(s),$(t).parent().next().first().html("￥"+s*d)}if("A"==t.tagName&&"del"==t.id&&$(t).parent().parent().remove(),"INPUT"==t.tagName&&"choose"==t.className&&1==t.checked){var a=Number($(t).parent().parent().find("#price").html()),n=Number($(t).parent().parent().find("#num").html());this.totalPrice+=a,this.totalNum+=n}if("INPUT"==t.tagName&&"choose"==t.className&&0==t.checked){a=Number($(t).parent().parent().find("#price").html()),n=Number($(t).parent().parent().find("#num").html());this.totalPrice-=a,this.totalNum-=n}this.countNum.html(this.totalNum),this.total.html(this.totalPrice)}}),(new List).init();